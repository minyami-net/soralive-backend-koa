roomchat json 协议

**command列表：**

| cmd | 命令 |
| --- | ---- |
| 1 | 加入房间 |
| 2 | 心跳包 |
| 3 | 评论信息 |
| 4 | 服务器指令 |

## Web端：

### 加入房间：

```json
{
    "token": "", // 已登录用户为登录token，未登录用户为空字符串
    "roomid": 2, // 房间对应的用户uid
    "cmd": 1
}
```

### 心跳包

```json
{
    "cmd": 2
}
```

### 发送评论

```json
{
    "cmd": 3,
    "comment": {
        "content": "评论内容"
    }
}
```

## 服务器

### 加入房间

```json
{
    "error": 0, // 0 - 加入成功， 1 - 加入失败
    "cmd": 1,
    "info": "info.success", // 服务器回复（失败原因）（成功时固定为info.success）
    "online": 15 // 在线人数
}
```

### 心跳包

```json
{
    "cmd": 2,
    "online": 15 // 在线人数
}
```

### 评论

```json
{
    "cmd": 3,
    "cmtId": "全局评论ID，用于跟踪评论内容复用DOM组件",
    "author": {
        "uid": 13, // UID
        "uname": "用户名"
    },
    "comment": {
        "content": "评论内容"
    },
    "createdAt": 100000000 //评论生成时间戳
}
```

### 服务器指令

**服务器指令对照表**:

| subCmd | 命令 | 附加信息内容 |
| ------ | ---- | ----------- |
| 1 | 禁言 | 禁言时间（秒）（如果有） |
| 2 | 取消禁言 | - |
| 3 | 封禁（立即退出直播间并置为未登录状态） | - |

```json
{
    "cmd": 4,
    "subCmd": 1, //子命令
    "extraInfo" : "附加信息文本",
    "createdAt": 100000000 //指令生成时间戳
}
```

### 系统通知

```json
{
    "cmd": 5,
    "comment": {
        "content": "系统通知内容"
    },
    "createdAt": 100000000 //通知生成时间戳
}